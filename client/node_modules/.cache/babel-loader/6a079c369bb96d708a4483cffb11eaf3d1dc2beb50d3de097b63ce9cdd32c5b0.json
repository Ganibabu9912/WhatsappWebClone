{"ast":null,"code":"import React,{useState,useRef,useEffect}from'react';import{format}from'date-fns';import{Send,Menu,Check,CheckCheck,Search,X}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ChatArea=_ref=>{let{conversation,messages,onSendMessage,onToggleSidebar}=_ref;const[messageText,setMessageText]=useState('');const[isTyping,setIsTyping]=useState(false);const[searchQuery,setSearchQuery]=useState('');const[searchResults,setSearchResults]=useState([]);const[currentSearchIndex,setCurrentSearchIndex]=useState(0);const[isSearchActive,setIsSearchActive]=useState(false);const messagesEndRef=useRef(null);const textareaRef=useRef(null);const searchInputRef=useRef(null);// Auto-scroll to bottom when new messages arrive\nuseEffect(()=>{var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});},[messages]);// Poll for message status updates\nuseEffect(()=>{if(!(conversation!==null&&conversation!==void 0&&conversation.wa_id))return;const pollStatusUpdates=async()=>{try{const response=await fetch(\"https://whatsappwebclone-ctfp.onrender.com/api/messages/status-updates/\".concat(conversation.wa_id));if(response.ok){const statusUpdates=await response.json();if(statusUpdates.length>0){// Trigger a refresh of messages to show updated statuses\n// This will be handled by the parent component\nif(window.refreshMessages){window.refreshMessages();}}}}catch(error){console.error('Error polling status updates:',error);}};const interval=setInterval(pollStatusUpdates,2000);// Poll every 2 seconds\nreturn()=>clearInterval(interval);},[conversation===null||conversation===void 0?void 0:conversation.wa_id]);// Auto-resize textarea\nuseEffect(()=>{if(textareaRef.current){textareaRef.current.style.height='auto';textareaRef.current.style.height=Math.min(textareaRef.current.scrollHeight,120)+'px';}},[messageText]);// Search functionality\nuseEffect(()=>{if(!searchQuery.trim()){setSearchResults([]);setCurrentSearchIndex(0);setIsSearchActive(false);return;}const results=messages.map((message,index)=>({message,index,text:message.text.body.toLowerCase()})).filter(item=>item.text.includes(searchQuery.toLowerCase()));setSearchResults(results);setCurrentSearchIndex(0);setIsSearchActive(results.length>0);},[searchQuery,messages]);// Scroll to highlighted message when search index changes\nuseEffect(()=>{if(searchResults.length>0&&currentSearchIndex<searchResults.length){const messageElement=document.querySelector(\"[data-message-index=\\\"\".concat(searchResults[currentSearchIndex].index,\"\\\"]\"));if(messageElement){messageElement.scrollIntoView({behavior:'smooth',block:'center'});}}},[currentSearchIndex,searchResults]);// Handle keyboard shortcuts for search\nuseEffect(()=>{const handleKeyDown=e=>{if(e.ctrlKey||e.metaKey){if(e.key==='f'){e.preventDefault();setIsSearchActive(true);setTimeout(()=>{var _searchInputRef$curre;return(_searchInputRef$curre=searchInputRef.current)===null||_searchInputRef$curre===void 0?void 0:_searchInputRef$curre.focus();},100);}}if(isSearchActive&&searchResults.length>0){if(e.key==='Enter'){e.preventDefault();setCurrentSearchIndex(prev=>(prev+1)%searchResults.length);}else if(e.key==='Escape'){e.preventDefault();setSearchQuery('');setIsSearchActive(false);}}};document.addEventListener('keydown',handleKeyDown);return()=>document.removeEventListener('keydown',handleKeyDown);},[isSearchActive,searchResults.length]);const handleSubmit=e=>{e.preventDefault();if(messageText.trim()&&!isTyping){onSendMessage(messageText);setMessageText('');if(textareaRef.current){textareaRef.current.style.height='44px';}}};const handleKeyPress=e=>{if(e.key==='Enter'&&!e.shiftKey){e.preventDefault();handleSubmit(e);}};const handleSearchChange=e=>{setSearchQuery(e.target.value);};const clearSearch=()=>{setSearchQuery('');setIsSearchActive(false);};const nextSearchResult=()=>{if(searchResults.length>0){setCurrentSearchIndex(prev=>(prev+1)%searchResults.length);}};const previousSearchResult=()=>{if(searchResults.length>0){setCurrentSearchIndex(prev=>(prev-1+searchResults.length)%searchResults.length);}};const isMessageHighlighted=messageIndex=>{return searchResults.some((result,index)=>result.index===messageIndex&&index===currentSearchIndex);};const getInitials=name=>{if(!name)return'?';return name.split(' ').map(word=>word.charAt(0)).join('').toUpperCase().slice(0,2);};const formatTime=timestamp=>{if(!timestamp)return'';const date=new Date(timestamp);return format(date,'HH:mm');};const getStatusIcon=status=>{switch(status){case'sent':return/*#__PURE__*/_jsx(Check,{className:\"status-icon sent\"});case'delivered':return/*#__PURE__*/_jsx(CheckCheck,{className:\"status-icon delivered\"});case'read':return/*#__PURE__*/_jsx(CheckCheck,{className:\"status-icon read\"});default:return/*#__PURE__*/_jsx(Check,{className:\"status-icon sent\"});}};if(!conversation){return/*#__PURE__*/_jsx(\"div\",{className:\"chat-area\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Welcome to WhatsApp Web\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Select a conversation to start chatting\"})]})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"chat-area\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"mobile-menu-button\",onClick:onToggleSidebar,children:/*#__PURE__*/_jsx(Menu,{})}),/*#__PURE__*/_jsx(\"div\",{className:\"avatar\",children:getInitials(conversation.name)}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-header-info\",children:[/*#__PURE__*/_jsx(\"h2\",{children:conversation.name}),/*#__PURE__*/_jsx(\"p\",{children:conversation.status==='online'?'online':conversation.status==='last seen'&&conversation.lastSeen?\"last seen \".concat(format(new Date(conversation.lastSeen),'HH:mm')):'offline'})]}),/*#__PURE__*/_jsx(\"button\",{className:\"search-toggle-button\",onClick:()=>setIsSearchActive(!isSearchActive),title:\"Search messages (Ctrl+F)\",children:/*#__PURE__*/_jsx(Search,{size:20})})]}),isSearchActive&&/*#__PURE__*/_jsx(\"div\",{className:\"chat-search-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"chat-search-box\",children:[/*#__PURE__*/_jsx(Search,{size:16,className:\"chat-search-icon\"}),/*#__PURE__*/_jsx(\"input\",{ref:searchInputRef,type:\"text\",placeholder:\"Search messages...\",value:searchQuery,onChange:handleSearchChange,className:\"chat-search-input\"}),searchQuery&&/*#__PURE__*/_jsx(\"button\",{className:\"chat-search-clear\",onClick:clearSearch,children:/*#__PURE__*/_jsx(X,{size:16})})]})}),searchResults.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-results-info\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"search-results-count\",children:[currentSearchIndex+1,\" of \",searchResults.length,\" results\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"search-results-nav\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"search-nav-button\",onClick:previousSearchResult,disabled:searchResults.length<=1,children:\"\\u2191 Previous\"}),/*#__PURE__*/_jsx(\"button\",{className:\"search-nav-button\",onClick:nextSearchResult,disabled:searchResults.length<=1,children:\"\\u2193 Next\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"messages-container\",children:[messages.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"empty-state\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"No messages yet\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Start the conversation by sending a message\"})]}):messages.map((message,index)=>/*#__PURE__*/_jsx(\"div\",{\"data-message-index\":index,className:\"message \".concat(message.direction==='out'?'outgoing':'incoming',\" \").concat(isMessageHighlighted(index)?'highlighted':''),children:/*#__PURE__*/_jsxs(\"div\",{className:\"message-bubble\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-text\",children:message.text.body}),/*#__PURE__*/_jsx(\"div\",{className:\"message-time\",children:formatTime(message.timestamp)}),message.direction==='out'&&/*#__PURE__*/_jsx(\"div\",{className:\"message-status\",children:getStatusIcon(message.status)})]})},message.id)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]}),/*#__PURE__*/_jsx(\"div\",{className:\"message-input-container\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:\"message-input-form\",children:[/*#__PURE__*/_jsx(\"textarea\",{ref:textareaRef,className:\"message-input\",value:messageText,onChange:e=>setMessageText(e.target.value),onKeyPress:handleKeyPress,placeholder:\"Type a message\",rows:\"1\",disabled:isTyping}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"send-button\",disabled:!messageText.trim()||isTyping,children:/*#__PURE__*/_jsx(Send,{size:20})})]})})]});};export default ChatArea;","map":{"version":3,"names":["React","useState","useRef","useEffect","format","Send","Menu","Check","CheckCheck","Search","X","jsx","_jsx","jsxs","_jsxs","ChatArea","_ref","conversation","messages","onSendMessage","onToggleSidebar","messageText","setMessageText","isTyping","setIsTyping","searchQuery","setSearchQuery","searchResults","setSearchResults","currentSearchIndex","setCurrentSearchIndex","isSearchActive","setIsSearchActive","messagesEndRef","textareaRef","searchInputRef","_messagesEndRef$curre","current","scrollIntoView","behavior","wa_id","pollStatusUpdates","response","fetch","concat","ok","statusUpdates","json","length","window","refreshMessages","error","console","interval","setInterval","clearInterval","style","height","Math","min","scrollHeight","trim","results","map","message","index","text","body","toLowerCase","filter","item","includes","messageElement","document","querySelector","block","handleKeyDown","e","ctrlKey","metaKey","key","preventDefault","setTimeout","_searchInputRef$curre","focus","prev","addEventListener","removeEventListener","handleSubmit","handleKeyPress","shiftKey","handleSearchChange","target","value","clearSearch","nextSearchResult","previousSearchResult","isMessageHighlighted","messageIndex","some","result","getInitials","name","split","word","charAt","join","toUpperCase","slice","formatTime","timestamp","date","Date","getStatusIcon","status","className","children","onClick","lastSeen","title","size","ref","type","placeholder","onChange","disabled","direction","id","onSubmit","onKeyPress","rows"],"sources":["D:/WhatsappWebClone/client/src/components/ChatArea.js"],"sourcesContent":["import React, { useState, useRef, useEffect } from 'react';\r\nimport { format } from 'date-fns';\r\nimport { Send, Menu, Check, CheckCheck, Search, X } from 'lucide-react';\r\n\r\nconst ChatArea = ({ conversation, messages, onSendMessage, onToggleSidebar }) => {\r\n  const [messageText, setMessageText] = useState('');\r\n  const [isTyping, setIsTyping] = useState(false);\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchResults, setSearchResults] = useState([]);\r\n  const [currentSearchIndex, setCurrentSearchIndex] = useState(0);\r\n  const [isSearchActive, setIsSearchActive] = useState(false);\r\n  const messagesEndRef = useRef(null);\r\n  const textareaRef = useRef(null);\r\n  const searchInputRef = useRef(null);\r\n\r\n  // Auto-scroll to bottom when new messages arrive\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }, [messages]);\r\n\r\n  // Poll for message status updates\r\n  useEffect(() => {\r\n    if (!conversation?.wa_id) return;\r\n\r\n    const pollStatusUpdates = async () => {\r\n      try {\r\n        const response = await fetch(`https://whatsappwebclone-ctfp.onrender.com/api/messages/status-updates/${conversation.wa_id}`);\r\n        if (response.ok) {\r\n          const statusUpdates = await response.json();\r\n          if (statusUpdates.length > 0) {\r\n            // Trigger a refresh of messages to show updated statuses\r\n            // This will be handled by the parent component\r\n            if (window.refreshMessages) {\r\n              window.refreshMessages();\r\n            }\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error('Error polling status updates:', error);\r\n      }\r\n    };\r\n\r\n    const interval = setInterval(pollStatusUpdates, 2000); // Poll every 2 seconds\r\n\r\n    return () => clearInterval(interval);\r\n  }, [conversation?.wa_id]);\r\n\r\n  // Auto-resize textarea\r\n  useEffect(() => {\r\n    if (textareaRef.current) {\r\n      textareaRef.current.style.height = 'auto';\r\n      textareaRef.current.style.height = Math.min(textareaRef.current.scrollHeight, 120) + 'px';\r\n    }\r\n  }, [messageText]);\r\n\r\n  // Search functionality\r\n  useEffect(() => {\r\n    if (!searchQuery.trim()) {\r\n      setSearchResults([]);\r\n      setCurrentSearchIndex(0);\r\n      setIsSearchActive(false);\r\n      return;\r\n    }\r\n\r\n    const results = messages\r\n      .map((message, index) => ({\r\n        message,\r\n        index,\r\n        text: message.text.body.toLowerCase()\r\n      }))\r\n      .filter(item => item.text.includes(searchQuery.toLowerCase()));\r\n\r\n    setSearchResults(results);\r\n    setCurrentSearchIndex(0);\r\n    setIsSearchActive(results.length > 0);\r\n  }, [searchQuery, messages]);\r\n\r\n  // Scroll to highlighted message when search index changes\r\n  useEffect(() => {\r\n    if (searchResults.length > 0 && currentSearchIndex < searchResults.length) {\r\n      const messageElement = document.querySelector(`[data-message-index=\"${searchResults[currentSearchIndex].index}\"]`);\r\n      if (messageElement) {\r\n        messageElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n      }\r\n    }\r\n  }, [currentSearchIndex, searchResults]);\r\n\r\n  // Handle keyboard shortcuts for search\r\n  useEffect(() => {\r\n    const handleKeyDown = (e) => {\r\n      if (e.ctrlKey || e.metaKey) {\r\n        if (e.key === 'f') {\r\n          e.preventDefault();\r\n          setIsSearchActive(true);\r\n          setTimeout(() => searchInputRef.current?.focus(), 100);\r\n        }\r\n      }\r\n      \r\n      if (isSearchActive && searchResults.length > 0) {\r\n        if (e.key === 'Enter') {\r\n          e.preventDefault();\r\n          setCurrentSearchIndex((prev) => (prev + 1) % searchResults.length);\r\n        } else if (e.key === 'Escape') {\r\n          e.preventDefault();\r\n          setSearchQuery('');\r\n          setIsSearchActive(false);\r\n        }\r\n      }\r\n    };\r\n\r\n    document.addEventListener('keydown', handleKeyDown);\r\n    return () => document.removeEventListener('keydown', handleKeyDown);\r\n  }, [isSearchActive, searchResults.length]);\r\n\r\n  const handleSubmit = (e) => {\r\n    e.preventDefault();\r\n    if (messageText.trim() && !isTyping) {\r\n      onSendMessage(messageText);\r\n      setMessageText('');\r\n      if (textareaRef.current) {\r\n        textareaRef.current.style.height = '44px';\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleKeyPress = (e) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault();\r\n      handleSubmit(e);\r\n    }\r\n  };\r\n\r\n  const handleSearchChange = (e) => {\r\n    setSearchQuery(e.target.value);\r\n  };\r\n\r\n  const clearSearch = () => {\r\n    setSearchQuery('');\r\n    setIsSearchActive(false);\r\n  };\r\n\r\n  const nextSearchResult = () => {\r\n    if (searchResults.length > 0) {\r\n      setCurrentSearchIndex((prev) => (prev + 1) % searchResults.length);\r\n    }\r\n  };\r\n\r\n  const previousSearchResult = () => {\r\n    if (searchResults.length > 0) {\r\n      setCurrentSearchIndex((prev) => (prev - 1 + searchResults.length) % searchResults.length);\r\n    }\r\n  };\r\n\r\n  const isMessageHighlighted = (messageIndex) => {\r\n    return searchResults.some((result, index) => \r\n      result.index === messageIndex && index === currentSearchIndex\r\n    );\r\n  };\r\n\r\n  const getInitials = (name) => {\r\n    if (!name) return '?';\r\n    return name\r\n      .split(' ')\r\n      .map(word => word.charAt(0))\r\n      .join('')\r\n      .toUpperCase()\r\n      .slice(0, 2);\r\n  };\r\n\r\n  const formatTime = (timestamp) => {\r\n    if (!timestamp) return '';\r\n    const date = new Date(timestamp);\r\n    return format(date, 'HH:mm');\r\n  };\r\n\r\n  const getStatusIcon = (status) => {\r\n    switch (status) {\r\n      case 'sent':\r\n        return <Check className=\"status-icon sent\" />;\r\n      case 'delivered':\r\n        return <CheckCheck className=\"status-icon delivered\" />;\r\n      case 'read':\r\n        return <CheckCheck className=\"status-icon read\" />;\r\n      default:\r\n        return <Check className=\"status-icon sent\" />;\r\n    }\r\n  };\r\n\r\n  if (!conversation) {\r\n    return (\r\n      <div className=\"chat-area\">\r\n        <div className=\"empty-state\">\r\n          <h2>Welcome to WhatsApp Web</h2>\r\n          <p>Select a conversation to start chatting</p>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"chat-area\">\r\n      {/* Chat Header */}\r\n      <div className=\"chat-header\">\r\n        <button className=\"mobile-menu-button\" onClick={onToggleSidebar}>\r\n          <Menu />\r\n        </button>\r\n        \r\n        <div className=\"avatar\">\r\n          {getInitials(conversation.name)}\r\n        </div>\r\n        \r\n        <div className=\"chat-header-info\">\r\n          <h2>{conversation.name}</h2>\r\n          <p>\r\n            {conversation.status === 'online' ? 'online' : \r\n             conversation.status === 'last seen' && conversation.lastSeen ? \r\n             `last seen ${format(new Date(conversation.lastSeen), 'HH:mm')}` : \r\n             'offline'}\r\n          </p>\r\n        </div>\r\n        \r\n        <button \r\n          className=\"search-toggle-button\"\r\n          onClick={() => setIsSearchActive(!isSearchActive)}\r\n          title=\"Search messages (Ctrl+F)\"\r\n        >\r\n          <Search size={20} />\r\n        </button>\r\n      </div>\r\n\r\n      {/* Search Bar */}\r\n      {isSearchActive && (\r\n        <div className=\"chat-search-container\">\r\n          <div className=\"chat-search-box\">\r\n            <Search size={16} className=\"chat-search-icon\" />\r\n            <input\r\n              ref={searchInputRef}\r\n              type=\"text\"\r\n              placeholder=\"Search messages...\"\r\n              value={searchQuery}\r\n              onChange={handleSearchChange}\r\n              className=\"chat-search-input\"\r\n            />\r\n            {searchQuery && (\r\n              <button className=\"chat-search-clear\" onClick={clearSearch}>\r\n                <X size={16} />\r\n              </button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Search Results Info */}\r\n      {searchResults.length > 0 && (\r\n        <div className=\"search-results-info\">\r\n          <span className=\"search-results-count\">\r\n            {currentSearchIndex + 1} of {searchResults.length} results\r\n          </span>\r\n          <div className=\"search-results-nav\">\r\n            <button \r\n              className=\"search-nav-button\"\r\n              onClick={previousSearchResult}\r\n              disabled={searchResults.length <= 1}\r\n            >\r\n              ↑ Previous\r\n            </button>\r\n            <button \r\n              className=\"search-nav-button\"\r\n              onClick={nextSearchResult}\r\n              disabled={searchResults.length <= 1}\r\n            >\r\n              ↓ Next\r\n            </button>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Messages Container */}\r\n      <div className=\"messages-container\">\r\n        {messages.length === 0 ? (\r\n          <div className=\"empty-state\">\r\n            <h2>No messages yet</h2>\r\n            <p>Start the conversation by sending a message</p>\r\n          </div>\r\n        ) : (\r\n          messages.map((message, index) => (\r\n            <div\r\n              key={message.id}\r\n              data-message-index={index}\r\n              className={`message ${message.direction === 'out' ? 'outgoing' : 'incoming'} ${\r\n                isMessageHighlighted(index) ? 'highlighted' : ''\r\n              }`}\r\n            >\r\n              <div className=\"message-bubble\">\r\n                <div className=\"message-text\">{message.text.body}</div>\r\n                <div className=\"message-time\">{formatTime(message.timestamp)}</div>\r\n                \r\n                {message.direction === 'out' && (\r\n                  <div className=\"message-status\">\r\n                    {getStatusIcon(message.status)}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n          ))\r\n        )}\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n\r\n      {/* Message Input */}\r\n      <div className=\"message-input-container\">\r\n        <form onSubmit={handleSubmit} className=\"message-input-form\">\r\n          <textarea\r\n            ref={textareaRef}\r\n            className=\"message-input\"\r\n            value={messageText}\r\n            onChange={(e) => setMessageText(e.target.value)}\r\n            onKeyPress={handleKeyPress}\r\n            placeholder=\"Type a message\"\r\n            rows=\"1\"\r\n            disabled={isTyping}\r\n          />\r\n          <button\r\n            type=\"submit\"\r\n            className=\"send-button\"\r\n            disabled={!messageText.trim() || isTyping}\r\n          >\r\n            <Send size={20} />\r\n          </button>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ChatArea; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,MAAM,CAAEC,SAAS,KAAQ,OAAO,CAC1D,OAASC,MAAM,KAAQ,UAAU,CACjC,OAASC,IAAI,CAAEC,IAAI,CAAEC,KAAK,CAAEC,UAAU,CAAEC,MAAM,CAAEC,CAAC,KAAQ,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAExE,KAAM,CAAAC,QAAQ,CAAGC,IAAA,EAAgE,IAA/D,CAAEC,YAAY,CAAEC,QAAQ,CAAEC,aAAa,CAAEC,eAAgB,CAAC,CAAAJ,IAAA,CAC1E,KAAM,CAACK,WAAW,CAAEC,cAAc,CAAC,CAAGrB,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAACsB,QAAQ,CAAEC,WAAW,CAAC,CAAGvB,QAAQ,CAAC,KAAK,CAAC,CAC/C,KAAM,CAACwB,WAAW,CAAEC,cAAc,CAAC,CAAGzB,QAAQ,CAAC,EAAE,CAAC,CAClD,KAAM,CAAC0B,aAAa,CAAEC,gBAAgB,CAAC,CAAG3B,QAAQ,CAAC,EAAE,CAAC,CACtD,KAAM,CAAC4B,kBAAkB,CAAEC,qBAAqB,CAAC,CAAG7B,QAAQ,CAAC,CAAC,CAAC,CAC/D,KAAM,CAAC8B,cAAc,CAAEC,iBAAiB,CAAC,CAAG/B,QAAQ,CAAC,KAAK,CAAC,CAC3D,KAAM,CAAAgC,cAAc,CAAG/B,MAAM,CAAC,IAAI,CAAC,CACnC,KAAM,CAAAgC,WAAW,CAAGhC,MAAM,CAAC,IAAI,CAAC,CAChC,KAAM,CAAAiC,cAAc,CAAGjC,MAAM,CAAC,IAAI,CAAC,CAEnC;AACAC,SAAS,CAAC,IAAM,KAAAiC,qBAAA,CACd,CAAAA,qBAAA,CAAAH,cAAc,CAACI,OAAO,UAAAD,qBAAA,iBAAtBA,qBAAA,CAAwBE,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAS,CAAC,CAAC,CAChE,CAAC,CAAE,CAACrB,QAAQ,CAAC,CAAC,CAEd;AACAf,SAAS,CAAC,IAAM,CACd,GAAI,EAACc,YAAY,SAAZA,YAAY,WAAZA,YAAY,CAAEuB,KAAK,EAAE,OAE1B,KAAM,CAAAC,iBAAiB,CAAG,KAAAA,CAAA,GAAY,CACpC,GAAI,CACF,KAAM,CAAAC,QAAQ,CAAG,KAAM,CAAAC,KAAK,2EAAAC,MAAA,CAA2E3B,YAAY,CAACuB,KAAK,CAAE,CAAC,CAC5H,GAAIE,QAAQ,CAACG,EAAE,CAAE,CACf,KAAM,CAAAC,aAAa,CAAG,KAAM,CAAAJ,QAAQ,CAACK,IAAI,CAAC,CAAC,CAC3C,GAAID,aAAa,CAACE,MAAM,CAAG,CAAC,CAAE,CAC5B;AACA;AACA,GAAIC,MAAM,CAACC,eAAe,CAAE,CAC1BD,MAAM,CAACC,eAAe,CAAC,CAAC,CAC1B,CACF,CACF,CACF,CAAE,MAAOC,KAAK,CAAE,CACdC,OAAO,CAACD,KAAK,CAAC,+BAA+B,CAAEA,KAAK,CAAC,CACvD,CACF,CAAC,CAED,KAAM,CAAAE,QAAQ,CAAGC,WAAW,CAACb,iBAAiB,CAAE,IAAI,CAAC,CAAE;AAEvD,MAAO,IAAMc,aAAa,CAACF,QAAQ,CAAC,CACtC,CAAC,CAAE,CAACpC,YAAY,SAAZA,YAAY,iBAAZA,YAAY,CAAEuB,KAAK,CAAC,CAAC,CAEzB;AACArC,SAAS,CAAC,IAAM,CACd,GAAI+B,WAAW,CAACG,OAAO,CAAE,CACvBH,WAAW,CAACG,OAAO,CAACmB,KAAK,CAACC,MAAM,CAAG,MAAM,CACzCvB,WAAW,CAACG,OAAO,CAACmB,KAAK,CAACC,MAAM,CAAGC,IAAI,CAACC,GAAG,CAACzB,WAAW,CAACG,OAAO,CAACuB,YAAY,CAAE,GAAG,CAAC,CAAG,IAAI,CAC3F,CACF,CAAC,CAAE,CAACvC,WAAW,CAAC,CAAC,CAEjB;AACAlB,SAAS,CAAC,IAAM,CACd,GAAI,CAACsB,WAAW,CAACoC,IAAI,CAAC,CAAC,CAAE,CACvBjC,gBAAgB,CAAC,EAAE,CAAC,CACpBE,qBAAqB,CAAC,CAAC,CAAC,CACxBE,iBAAiB,CAAC,KAAK,CAAC,CACxB,OACF,CAEA,KAAM,CAAA8B,OAAO,CAAG5C,QAAQ,CACrB6C,GAAG,CAAC,CAACC,OAAO,CAAEC,KAAK,IAAM,CACxBD,OAAO,CACPC,KAAK,CACLC,IAAI,CAAEF,OAAO,CAACE,IAAI,CAACC,IAAI,CAACC,WAAW,CAAC,CACtC,CAAC,CAAC,CAAC,CACFC,MAAM,CAACC,IAAI,EAAIA,IAAI,CAACJ,IAAI,CAACK,QAAQ,CAAC9C,WAAW,CAAC2C,WAAW,CAAC,CAAC,CAAC,CAAC,CAEhExC,gBAAgB,CAACkC,OAAO,CAAC,CACzBhC,qBAAqB,CAAC,CAAC,CAAC,CACxBE,iBAAiB,CAAC8B,OAAO,CAACd,MAAM,CAAG,CAAC,CAAC,CACvC,CAAC,CAAE,CAACvB,WAAW,CAAEP,QAAQ,CAAC,CAAC,CAE3B;AACAf,SAAS,CAAC,IAAM,CACd,GAAIwB,aAAa,CAACqB,MAAM,CAAG,CAAC,EAAInB,kBAAkB,CAAGF,aAAa,CAACqB,MAAM,CAAE,CACzE,KAAM,CAAAwB,cAAc,CAAGC,QAAQ,CAACC,aAAa,0BAAA9B,MAAA,CAAyBjB,aAAa,CAACE,kBAAkB,CAAC,CAACoC,KAAK,OAAI,CAAC,CAClH,GAAIO,cAAc,CAAE,CAClBA,cAAc,CAAClC,cAAc,CAAC,CAAEC,QAAQ,CAAE,QAAQ,CAAEoC,KAAK,CAAE,QAAS,CAAC,CAAC,CACxE,CACF,CACF,CAAC,CAAE,CAAC9C,kBAAkB,CAAEF,aAAa,CAAC,CAAC,CAEvC;AACAxB,SAAS,CAAC,IAAM,CACd,KAAM,CAAAyE,aAAa,CAAIC,CAAC,EAAK,CAC3B,GAAIA,CAAC,CAACC,OAAO,EAAID,CAAC,CAACE,OAAO,CAAE,CAC1B,GAAIF,CAAC,CAACG,GAAG,GAAK,GAAG,CAAE,CACjBH,CAAC,CAACI,cAAc,CAAC,CAAC,CAClBjD,iBAAiB,CAAC,IAAI,CAAC,CACvBkD,UAAU,CAAC,SAAAC,qBAAA,QAAAA,qBAAA,CAAMhD,cAAc,CAACE,OAAO,UAAA8C,qBAAA,iBAAtBA,qBAAA,CAAwBC,KAAK,CAAC,CAAC,GAAE,GAAG,CAAC,CACxD,CACF,CAEA,GAAIrD,cAAc,EAAIJ,aAAa,CAACqB,MAAM,CAAG,CAAC,CAAE,CAC9C,GAAI6B,CAAC,CAACG,GAAG,GAAK,OAAO,CAAE,CACrBH,CAAC,CAACI,cAAc,CAAC,CAAC,CAClBnD,qBAAqB,CAAEuD,IAAI,EAAK,CAACA,IAAI,CAAG,CAAC,EAAI1D,aAAa,CAACqB,MAAM,CAAC,CACpE,CAAC,IAAM,IAAI6B,CAAC,CAACG,GAAG,GAAK,QAAQ,CAAE,CAC7BH,CAAC,CAACI,cAAc,CAAC,CAAC,CAClBvD,cAAc,CAAC,EAAE,CAAC,CAClBM,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CACF,CACF,CAAC,CAEDyC,QAAQ,CAACa,gBAAgB,CAAC,SAAS,CAAEV,aAAa,CAAC,CACnD,MAAO,IAAMH,QAAQ,CAACc,mBAAmB,CAAC,SAAS,CAAEX,aAAa,CAAC,CACrE,CAAC,CAAE,CAAC7C,cAAc,CAAEJ,aAAa,CAACqB,MAAM,CAAC,CAAC,CAE1C,KAAM,CAAAwC,YAAY,CAAIX,CAAC,EAAK,CAC1BA,CAAC,CAACI,cAAc,CAAC,CAAC,CAClB,GAAI5D,WAAW,CAACwC,IAAI,CAAC,CAAC,EAAI,CAACtC,QAAQ,CAAE,CACnCJ,aAAa,CAACE,WAAW,CAAC,CAC1BC,cAAc,CAAC,EAAE,CAAC,CAClB,GAAIY,WAAW,CAACG,OAAO,CAAE,CACvBH,WAAW,CAACG,OAAO,CAACmB,KAAK,CAACC,MAAM,CAAG,MAAM,CAC3C,CACF,CACF,CAAC,CAED,KAAM,CAAAgC,cAAc,CAAIZ,CAAC,EAAK,CAC5B,GAAIA,CAAC,CAACG,GAAG,GAAK,OAAO,EAAI,CAACH,CAAC,CAACa,QAAQ,CAAE,CACpCb,CAAC,CAACI,cAAc,CAAC,CAAC,CAClBO,YAAY,CAACX,CAAC,CAAC,CACjB,CACF,CAAC,CAED,KAAM,CAAAc,kBAAkB,CAAId,CAAC,EAAK,CAChCnD,cAAc,CAACmD,CAAC,CAACe,MAAM,CAACC,KAAK,CAAC,CAChC,CAAC,CAED,KAAM,CAAAC,WAAW,CAAGA,CAAA,GAAM,CACxBpE,cAAc,CAAC,EAAE,CAAC,CAClBM,iBAAiB,CAAC,KAAK,CAAC,CAC1B,CAAC,CAED,KAAM,CAAA+D,gBAAgB,CAAGA,CAAA,GAAM,CAC7B,GAAIpE,aAAa,CAACqB,MAAM,CAAG,CAAC,CAAE,CAC5BlB,qBAAqB,CAAEuD,IAAI,EAAK,CAACA,IAAI,CAAG,CAAC,EAAI1D,aAAa,CAACqB,MAAM,CAAC,CACpE,CACF,CAAC,CAED,KAAM,CAAAgD,oBAAoB,CAAGA,CAAA,GAAM,CACjC,GAAIrE,aAAa,CAACqB,MAAM,CAAG,CAAC,CAAE,CAC5BlB,qBAAqB,CAAEuD,IAAI,EAAK,CAACA,IAAI,CAAG,CAAC,CAAG1D,aAAa,CAACqB,MAAM,EAAIrB,aAAa,CAACqB,MAAM,CAAC,CAC3F,CACF,CAAC,CAED,KAAM,CAAAiD,oBAAoB,CAAIC,YAAY,EAAK,CAC7C,MAAO,CAAAvE,aAAa,CAACwE,IAAI,CAAC,CAACC,MAAM,CAAEnC,KAAK,GACtCmC,MAAM,CAACnC,KAAK,GAAKiC,YAAY,EAAIjC,KAAK,GAAKpC,kBAC7C,CAAC,CACH,CAAC,CAED,KAAM,CAAAwE,WAAW,CAAIC,IAAI,EAAK,CAC5B,GAAI,CAACA,IAAI,CAAE,MAAO,GAAG,CACrB,MAAO,CAAAA,IAAI,CACRC,KAAK,CAAC,GAAG,CAAC,CACVxC,GAAG,CAACyC,IAAI,EAAIA,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC,CAAC,CAC3BC,IAAI,CAAC,EAAE,CAAC,CACRC,WAAW,CAAC,CAAC,CACbC,KAAK,CAAC,CAAC,CAAE,CAAC,CAAC,CAChB,CAAC,CAED,KAAM,CAAAC,UAAU,CAAIC,SAAS,EAAK,CAChC,GAAI,CAACA,SAAS,CAAE,MAAO,EAAE,CACzB,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAACF,SAAS,CAAC,CAChC,MAAO,CAAA1G,MAAM,CAAC2G,IAAI,CAAE,OAAO,CAAC,CAC9B,CAAC,CAED,KAAM,CAAAE,aAAa,CAAIC,MAAM,EAAK,CAChC,OAAQA,MAAM,EACZ,IAAK,MAAM,CACT,mBAAOtG,IAAA,CAACL,KAAK,EAAC4G,SAAS,CAAC,kBAAkB,CAAE,CAAC,CAC/C,IAAK,WAAW,CACd,mBAAOvG,IAAA,CAACJ,UAAU,EAAC2G,SAAS,CAAC,uBAAuB,CAAE,CAAC,CACzD,IAAK,MAAM,CACT,mBAAOvG,IAAA,CAACJ,UAAU,EAAC2G,SAAS,CAAC,kBAAkB,CAAE,CAAC,CACpD,QACE,mBAAOvG,IAAA,CAACL,KAAK,EAAC4G,SAAS,CAAC,kBAAkB,CAAE,CAAC,CACjD,CACF,CAAC,CAED,GAAI,CAAClG,YAAY,CAAE,CACjB,mBACEL,IAAA,QAAKuG,SAAS,CAAC,WAAW,CAAAC,QAAA,cACxBtG,KAAA,QAAKqG,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BxG,IAAA,OAAAwG,QAAA,CAAI,yBAAuB,CAAI,CAAC,cAChCxG,IAAA,MAAAwG,QAAA,CAAG,yCAAuC,CAAG,CAAC,EAC3C,CAAC,CACH,CAAC,CAEV,CAEA,mBACEtG,KAAA,QAAKqG,SAAS,CAAC,WAAW,CAAAC,QAAA,eAExBtG,KAAA,QAAKqG,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BxG,IAAA,WAAQuG,SAAS,CAAC,oBAAoB,CAACE,OAAO,CAAEjG,eAAgB,CAAAgG,QAAA,cAC9DxG,IAAA,CAACN,IAAI,GAAE,CAAC,CACF,CAAC,cAETM,IAAA,QAAKuG,SAAS,CAAC,QAAQ,CAAAC,QAAA,CACpBf,WAAW,CAACpF,YAAY,CAACqF,IAAI,CAAC,CAC5B,CAAC,cAENxF,KAAA,QAAKqG,SAAS,CAAC,kBAAkB,CAAAC,QAAA,eAC/BxG,IAAA,OAAAwG,QAAA,CAAKnG,YAAY,CAACqF,IAAI,CAAK,CAAC,cAC5B1F,IAAA,MAAAwG,QAAA,CACGnG,YAAY,CAACiG,MAAM,GAAK,QAAQ,CAAG,QAAQ,CAC3CjG,YAAY,CAACiG,MAAM,GAAK,WAAW,EAAIjG,YAAY,CAACqG,QAAQ,cAAA1E,MAAA,CAC/CxC,MAAM,CAAC,GAAI,CAAA4G,IAAI,CAAC/F,YAAY,CAACqG,QAAQ,CAAC,CAAE,OAAO,CAAC,EAC7D,SAAS,CACT,CAAC,EACD,CAAC,cAEN1G,IAAA,WACEuG,SAAS,CAAC,sBAAsB,CAChCE,OAAO,CAAEA,CAAA,GAAMrF,iBAAiB,CAAC,CAACD,cAAc,CAAE,CAClDwF,KAAK,CAAC,0BAA0B,CAAAH,QAAA,cAEhCxG,IAAA,CAACH,MAAM,EAAC+G,IAAI,CAAE,EAAG,CAAE,CAAC,CACd,CAAC,EACN,CAAC,CAGLzF,cAAc,eACbnB,IAAA,QAAKuG,SAAS,CAAC,uBAAuB,CAAAC,QAAA,cACpCtG,KAAA,QAAKqG,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BxG,IAAA,CAACH,MAAM,EAAC+G,IAAI,CAAE,EAAG,CAACL,SAAS,CAAC,kBAAkB,CAAE,CAAC,cACjDvG,IAAA,UACE6G,GAAG,CAAEtF,cAAe,CACpBuF,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,oBAAoB,CAChC9B,KAAK,CAAEpE,WAAY,CACnBmG,QAAQ,CAAEjC,kBAAmB,CAC7BwB,SAAS,CAAC,mBAAmB,CAC9B,CAAC,CACD1F,WAAW,eACVb,IAAA,WAAQuG,SAAS,CAAC,mBAAmB,CAACE,OAAO,CAAEvB,WAAY,CAAAsB,QAAA,cACzDxG,IAAA,CAACF,CAAC,EAAC8G,IAAI,CAAE,EAAG,CAAE,CAAC,CACT,CACT,EACE,CAAC,CACH,CACN,CAGA7F,aAAa,CAACqB,MAAM,CAAG,CAAC,eACvBlC,KAAA,QAAKqG,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAClCtG,KAAA,SAAMqG,SAAS,CAAC,sBAAsB,CAAAC,QAAA,EACnCvF,kBAAkB,CAAG,CAAC,CAAC,MAAI,CAACF,aAAa,CAACqB,MAAM,CAAC,UACpD,EAAM,CAAC,cACPlC,KAAA,QAAKqG,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eACjCxG,IAAA,WACEuG,SAAS,CAAC,mBAAmB,CAC7BE,OAAO,CAAErB,oBAAqB,CAC9B6B,QAAQ,CAAElG,aAAa,CAACqB,MAAM,EAAI,CAAE,CAAAoE,QAAA,CACrC,iBAED,CAAQ,CAAC,cACTxG,IAAA,WACEuG,SAAS,CAAC,mBAAmB,CAC7BE,OAAO,CAAEtB,gBAAiB,CAC1B8B,QAAQ,CAAElG,aAAa,CAACqB,MAAM,EAAI,CAAE,CAAAoE,QAAA,CACrC,aAED,CAAQ,CAAC,EACN,CAAC,EACH,CACN,cAGDtG,KAAA,QAAKqG,SAAS,CAAC,oBAAoB,CAAAC,QAAA,EAChClG,QAAQ,CAAC8B,MAAM,GAAK,CAAC,cACpBlC,KAAA,QAAKqG,SAAS,CAAC,aAAa,CAAAC,QAAA,eAC1BxG,IAAA,OAAAwG,QAAA,CAAI,iBAAe,CAAI,CAAC,cACxBxG,IAAA,MAAAwG,QAAA,CAAG,6CAA2C,CAAG,CAAC,EAC/C,CAAC,CAENlG,QAAQ,CAAC6C,GAAG,CAAC,CAACC,OAAO,CAAEC,KAAK,gBAC1BrD,IAAA,QAEE,qBAAoBqD,KAAM,CAC1BkD,SAAS,YAAAvE,MAAA,CAAaoB,OAAO,CAAC8D,SAAS,GAAK,KAAK,CAAG,UAAU,CAAG,UAAU,MAAAlF,MAAA,CACzEqD,oBAAoB,CAAChC,KAAK,CAAC,CAAG,aAAa,CAAG,EAAE,CAC/C,CAAAmD,QAAA,cAEHtG,KAAA,QAAKqG,SAAS,CAAC,gBAAgB,CAAAC,QAAA,eAC7BxG,IAAA,QAAKuG,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAEpD,OAAO,CAACE,IAAI,CAACC,IAAI,CAAM,CAAC,cACvDvD,IAAA,QAAKuG,SAAS,CAAC,cAAc,CAAAC,QAAA,CAAEP,UAAU,CAAC7C,OAAO,CAAC8C,SAAS,CAAC,CAAM,CAAC,CAElE9C,OAAO,CAAC8D,SAAS,GAAK,KAAK,eAC1BlH,IAAA,QAAKuG,SAAS,CAAC,gBAAgB,CAAAC,QAAA,CAC5BH,aAAa,CAACjD,OAAO,CAACkD,MAAM,CAAC,CAC3B,CACN,EACE,CAAC,EAfDlD,OAAO,CAAC+D,EAgBV,CACN,CACF,cACDnH,IAAA,QAAK6G,GAAG,CAAExF,cAAe,CAAE,CAAC,EACzB,CAAC,cAGNrB,IAAA,QAAKuG,SAAS,CAAC,yBAAyB,CAAAC,QAAA,cACtCtG,KAAA,SAAMkH,QAAQ,CAAExC,YAAa,CAAC2B,SAAS,CAAC,oBAAoB,CAAAC,QAAA,eAC1DxG,IAAA,aACE6G,GAAG,CAAEvF,WAAY,CACjBiF,SAAS,CAAC,eAAe,CACzBtB,KAAK,CAAExE,WAAY,CACnBuG,QAAQ,CAAG/C,CAAC,EAAKvD,cAAc,CAACuD,CAAC,CAACe,MAAM,CAACC,KAAK,CAAE,CAChDoC,UAAU,CAAExC,cAAe,CAC3BkC,WAAW,CAAC,gBAAgB,CAC5BO,IAAI,CAAC,GAAG,CACRL,QAAQ,CAAEtG,QAAS,CACpB,CAAC,cACFX,IAAA,WACE8G,IAAI,CAAC,QAAQ,CACbP,SAAS,CAAC,aAAa,CACvBU,QAAQ,CAAE,CAACxG,WAAW,CAACwC,IAAI,CAAC,CAAC,EAAItC,QAAS,CAAA6F,QAAA,cAE1CxG,IAAA,CAACP,IAAI,EAACmH,IAAI,CAAE,EAAG,CAAE,CAAC,CACZ,CAAC,EACL,CAAC,CACJ,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAzG,QAAQ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}